/*! df-tab-menu - v0.2.0 - Responsive tabs with dropdown menu - built 2014-10-14 - License MIT (http://www.opensource.org/licenses/MIT) */
!function(){"use strict";angular.module("digitalfondue.dftabmenu",[]).directive("dfTabMenu",["$window","$timeout",function(a,b){return{restrict:"A",compile:function(c,d){function e(a){return i?a:""}var f=a.document,g=c[0],h=g.tagName;if("UL"!==h&&"OL"!==h)throw"Wrong element: only OL and UL are supported by df-tab-menu";var i="bootstrap"===d.theme;angular.element(g).attr("role","tablist").addClass("df-tab-menu "+e("nav nav-tabs")),angular.element(g).append('<li role="more-menu-toggle" '+e('class="dropdown"')+'><a href dropdown-toggle class="dropdown-toggle">'+d.moreMenuTemplate+"</a><"+h+' role="more-menu" class="df-tab-menu-dropdown '+e("dropdown-menu")+'"></'+h+"></li>");for(var j=angular.element(g.querySelector(".df-tab-menu-dropdown")),k=g.querySelectorAll("li[menu-item]"),l=angular.element(k),m=0;m<l.length;m++){var n=angular.element(k[m]).clone();n.attr({role:"more-menu-item"}),j.append(n),angular.element(k[m]).attr({"aria-selected":"false",role:"tab"})}return function(c,d,e){var g=d[0],h=angular.element(a),j=!1,k=function(){var a=g.querySelectorAll("li[role=tab]");angular.element(a).removeClass("ng-hide");for(var b=[],c=0;c<a.length;c++){var d=a[c].offsetWidth;d>0&&(b[c]=a[c].offsetWidth)}return b},l=(c.$watch(function(){var a=g.querySelector("li[role=tab].df-tab-menu-active");return null!=a?a.scrollWidth:0},function(a){null!=a&&a>0&&o()},!0),function(){return angular.element(g.querySelector("li[role=more-menu-toggle]")).removeClass("ng-hide"),g.querySelector("li[role=more-menu-toggle]").offsetWidth}),m=function(a,b){var c=[],d=k(),e=d[b]+l()+40;c.push(b);for(var f=g.querySelectorAll("li[role=tab]"),h=0;h<f.length;h++)if(h!=b){if(e+=d[h],e>a)return c;c.push(h)}return c},n=function(){for(var a=g.querySelectorAll("li[role=tab]"),b=0;b<a.length;b++)if(angular.element(a[b]).hasClass("df-tab-menu-active"))return b},o=function(){var a=g.offsetWidth,b=n(),c=m(a,b),d=g.querySelectorAll("li[role=tab]"),e=g.querySelectorAll("li[role=more-menu-item]"),f=g.querySelector("li[role=more-menu-toggle]");if(c.length<g.querySelectorAll("li[role=tab]").length){angular.element(f).removeClass("ng-hide").attr("aria-hidden","false");for(var h=0;h<d.length;h++)-1!=c.indexOf(h)?(angular.element(d[h]).removeClass("ng-hide").attr("aria-hidden","false"),angular.element(e[h]).addClass("ng-hide").attr("aria-hidden","true")):(angular.element(d[h]).addClass("ng-hide").attr("aria-hidden","true"),angular.element(e[h]).removeClass("ng-hide").attr("aria-hidden","false"))}else angular.element(f).addClass("ng-hide").attr("aria-hidden","true"),angular.element(d).removeClass("ng-hide").attr("aria-hidden","false"),j=!1,q()},p=function(a){j=!1,q(a)},q=function(){j?(i&&angular.element(g.querySelector("li[role=more-menu-toggle]")).addClass("open"),angular.element(g.querySelector("li[role=more-menu-toggle] a[dropdown-toggle]")).addClass("df-tab-menu-dropdown-open"),angular.element(f).bind("click",p)):(i&&angular.element(g.querySelector("li[role=more-menu-toggle]")).removeClass("open"),angular.element(g.querySelector("li[role=more-menu-toggle] a[dropdown-toggle]")).removeClass("df-tab-menu-dropdown-open"),angular.element(f).unbind("click",p))},r=function(a){a&&a.stopPropagation(),j=!j,q()};angular.element(g.querySelector("li[role=more-menu-toggle] a[dropdown-toggle]")).bind("click",r);var s=function(a){var b=angular.element(g.querySelector("li.df-tab-menu-active")).removeClass("df-tab-menu-active").attr("aria-selected","false"),c=angular.element(g.querySelector('li[menu-item="'+a+'"]')).addClass("df-tab-menu-active").attr("aria-selected","true");i&&(b.removeClass("active"),c.addClass("active"))};e.$observe("menuControl",function(a){o(),s(a)}),h.bind("resize",o),c.$on("$destroy",function(){h.unbind("resize",o),angular.element(g.querySelector("li[role=more-menu-toggle] a[dropdown-toggle]")).unbind("click",r),angular.element(f).unbind("click",p)});var t;c.$watch(function(){b.cancel(t),t=b(function(){o(),s(e.menuControl)},25,!1)})}}}}])}();